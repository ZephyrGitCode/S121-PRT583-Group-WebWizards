CREATE TABLE `users` (
  id INT(11) NOT NULL AUTO_INCREMENT,
  PRIMARY KEY (id),
  fname VARCHAR(40) NOT NULL,
  lname VARCHAR(40) NOT NULL,
  email VARCHAR(60) NOT NULL,
  UNIQUE (email),
  studentnum VARCHAR(7),
  isadmin tinyint(1) DEFAULT 1,
  # Assuming SHA256 hash
  hashed_password CHAR(64) NOT NULL,
  # Assuming 16 chars in salt
  salt CHAR(16) NOT NULL
) ENGINE=INNODB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;

CREATE TABLE `items` (
  itemNo INT(4) NOT NULL AUTO_INCREMENT,
  vendorNo INT(2) NOT NULL,
  itemName VARCHAR(40) NOT NULL,
  itemDesc VARCHAR(255) NOT NULL,
  price FLOAT(24) NOT NULL,
  PRIMARY KEY (itemNo)
) ENGINE=INNODB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;

CREATE TABLE `vendors` (
  vendorNo INT(2) NOT NULL AUTO_INCREMENT,
  vendorName INT(2) NOT NULL,
  location VARCHAR(40) NOT NULL,
  PRIMARY KEY (vendorNo)
) ENGINE=INNODB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;


CREATE TABLE `orders` (
  orderNo INT(11) NOT NULL AUTO_INCREMENT,
  PRIMARY KEY (orderNo),
  userNo INT(11) NOT NULL,
  CONSTRAINT FOREIGN KEY (userNo) REFERENCES users(id) ON DELETE CASCADE ON UPDATE CASCADE,
  pickuptime TIMESTAMP,
  odate TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
) ENGINE=INNODB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;

CREATE TABLE `orderitems` (
  orderNo INT(11) NOT NULL,
  itemNo INT(11) NOT NULL,
  quantity INT(3) NOT NULL,
  PRIMARY KEY (orderNo, itemNo),
  FOREIGN KEY (orderNo) REFERENCES orders(orderNo) ON DELETE CASCADE ON UPDATE CASCADE,
  FOREIGN KEY (itemNo) REFERENCES items(itemNo) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=INNODB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;